<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Code Prototype]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://blog.codeprototype.com/"/>
  <updated>2015-03-22T02:56:50.000Z</updated>
  <id>http://blog.codeprototype.com/</id>
  
  <author>
    <name><![CDATA[Kevin Le]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Host multiple sites using Node.js]]></title>
    <link href="http://blog.codeprototype.com/2015/03/22/host-multiple-sites-using-nodejs/"/>
    <id>http://blog.codeprototype.com/2015/03/22/host-multiple-sites-using-nodejs/</id>
    <published>2015-03-22T02:27:34.000Z</published>
    <updated>2015-03-22T02:56:50.000Z</updated>
    <content type="html"><![CDATA[<p>Reposting from <a href="https://medium.com/@kevinle/host-multiple-sites-using-node-js-fff1ef7d0534" target="_blank" rel="external">https://medium.com/@kevinle/host-multiple-sites-using-node-js-fff1ef7d0534</a>.</p>
<p>This <a href="http://stackoverflow.com/questions/19254583/how-do-i-host-multiple-node-js-sites-on-the-same-ip-server-with-different-domain" target="_blank" rel="external">question</a> was asked on Stackoverflow. Several answers which involved using some sort of proxy or reverse proxy in nginx, including this <a href="https://www.digitalocean.com/community/tutorials/how-to-host-multiple-node-js-applications-on-a-single-vps-with-nginx-forever-and-crontab" target="_blank" rel="external">one</a> from Digital Ocean were given. I prefer to do without having to install either Apache or nginx so here is how I do it.</p>
<p>First create a script that would run on startup:</p>
<script src="https://gist.github.com/pragmaticlogic/cd62b6e768862d53adff.js"></script>


<p>Save this script to <strong>/etc/init.d</strong> or create a symbolic link in <strong>/etc/init.d</strong> that points to that script.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$: <span class="built_in">cd</span> /etc/init.d</span><br><span class="line">$: sudo ln <span class="operator">-s</span> ~/startup/node-apps-startup.sh node-apps</span><br><span class="line">$: sudo update-rc.d node-apps defaults</span><br><span class="line">$: sudo update-rc.d node-apps <span class="built_in">enable</span></span><br></pre></td></tr></table></figure>
<p>Also make sure that you install <a href="https://github.com/foreverjs/forever" target="_blank" rel="external">forever</a> and <a href="https://github.com/substack/bouncy" target="_blank" rel="external">bouncy</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$: npm install -g forever</span><br><span class="line">$: npm install -g bouncy</span><br></pre></td></tr></table></figure>
<p>In the bouncy directory, create a file called <strong>routes.json</strong> like this</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    “app1.domain.com" : 5000,    </span><br><span class="line">    “app2.domain.com" : 5001</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As I commented inline in the startup script above, the <strong>iptables</strong> command routes all traffic from port 80 to port 8000 where <strong>bouncy</strong> runs. There are many guides and tutorials on <strong>iptables</strong> which is a fairly powerful and complicated firewall tool, but for me this <a href="http://www.debuntu.org/how-to-redirecting-network-traffic-to-a-new-ip-using-iptables/" target="_blank" rel="external">one guide</a> seems to make it easy for me to understand. Since this involves port 80, a <strong>sudo</strong> elevation level is required. <strong>bouncy</strong> then based on its <strong>routes.json</strong> mapping, pipes traffic to the right endpoints. So I can easily keep track of all of my Node.js applications, I randomly pick the number 5000 and let this be the starting port where my app1, app2, etc run on.</p>
<p>In the above example, I have app1.domain.com and app2.domain.com subdomains A records created with my DNS management provider, and they all point to the same IP address of my VPS server.</p>
<p>Lastly, here are a couple of applications that I’m currently working on but prove that the above approach does work:</p>
<p><a href="http://react-mui-auth.codeprototype.com/" target="_blank" rel="external">http://react-mui-auth.codeprototype.com/</a></p>
<p><a href="http://connect5.codeprototype.com/" target="_blank" rel="external">http://connect5.codeprototype.com/</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Reposting from <a href="https://medium.com/@kevinle/host-multiple-sites-using-node-js-fff1ef7d0534" target="_blank" rel="external">https:]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Later Medium, Hello Hexo]]></title>
    <link href="http://blog.codeprototype.com/2015/03/22/hello-world/"/>
    <id>http://blog.codeprototype.com/2015/03/22/hello-world/</id>
    <published>2015-03-22T02:25:32.000Z</published>
    <updated>2015-03-22T02:25:32.000Z</updated>
    <content type="html"><![CDATA[<p>I only started using <a href="http://medium.com/@kevinle" target="_blank" rel="external">Medium</a> recently, and published my <a href="https://medium.com/@kevinle/host-multiple-sites-using-node-js-fff1ef7d0534" target="_blank" rel="external">first post</a> on March 1st, 2015.  So 3 weeks ago, I didn’t find anything better than Medium and I still don’t.  It is the best option now and probably will be for a long time.  It provides the best writing experience and the design, as everyone will agree, is just beautiful.  But how much longer will Medium continue to be free of charge and at the same time ad-free?  I’m not the first one to <a href="https://medium.com/@itsjoeturner/how-will-medium-make-its-money-eb913127403f" target="_blank" rel="external">ask this question</a>, and <a href="http://www.quora.com/How-does-Medium-plan-to-monetize" target="_blank" rel="external">no one knows the answer</a>.</p>
<p>Then 4 days ago, on March 17th, 2015 this <a href="http://www.sitepoint.com/6-nodejs-static-site-generators/?utm_source=nodeweekly&amp;utm_medium=email" target="_blank" rel="external">article</a> was published on SitePoint.  I checked it out anyway, but didn’t think I would be easily persuaded.  But <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a> is just too tempting.  It has all the features I would want, so I had to convince myself to switch from Medium to using Hexo.  Here’s how I convinced myself:</p>
<ol>
<li>Either I do the switch now or do it many posts later, which would require much bigger efforts.</li>
<li>I cannot use my <a href="https://medium.com/the-story/custom-domains-for-publications-8cb161d9651" target="_blank" rel="external">custom domain</a> on Medium.  Maybe, this is how they’ll make money ?</li>
<li><a href="https://medium.com/@kanyang/how-to-display-code-blocks-in-medium-687b3a14e47a" target="_blank" rel="external">Code blocks</a> on Medium is not as nice.</li>
<li><a href="http://jsfiddle.net/" target="_blank" rel="external">jsfiddle</a>, <a href="http://codepen.io/" target="_blank" rel="external">codepen</a>, etc cannot be embedded on Medium.</li>
</ol>
<p>While Medium might be the best fit for many people, and I plan to continue use it from time to time, I also decide that I will start using <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a> as my primary platform.  So hello <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>.</p>
<p>How can I make up for the lost writing experience that is only available on Medium ?  I use <a href="http://bywordapp.com" target="_blank" rel="external">ByWord</a> on my Mac when I have it with me, but frankly Markdown becomes second nature after a few posts anyway. </p>
<p>I leave the <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> here for anyone who is on the same boat as I was and for my future reference. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>I only started using <a href="http://medium.com/@kevinle" target="_blank" rel="external">Medium</a> recently, and published my <a href="h]]>
    </summary>
    
  </entry>
  
</feed>